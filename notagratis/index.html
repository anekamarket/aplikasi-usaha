<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Online Store Pro</title>
    <!-- External CSS -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-daterangepicker/3.0.5/daterangepicker.min.css">
    <!-- Local CSS -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Toast Notification -->
    <div id="toast" class="toast">
        <i class="fas fa-info-circle"></i>
        <span id="toast-message">Notification message</span>
    </div>

    <!-- Confirmation Dialog -->
    <div id="confirmationDialog" class="confirmation-dialog" style="display: none;">
        <div class="confirmation-content">
            <h4 id="confirmationMessage">Apakah Anda yakin?</h4>
            <div class="confirmation-buttons">
                <button id="confirmCancel" class="btn btn-secondary">Batal</button>
                <button id="confirmOk" class="btn btn-danger">Ya, Hapus</button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none;">
        <div class="loading-spinner"></div>
        <p id="loadingText">Memproses...</p>
    </div>

    <!-- Settings Button -->
    <div class="settings-button" id="settingsButton">
        <i class="fas fa-cog"></i>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="settings-modal">
        <div class="settings-content">
            <div class="modal-header">
                <h3 class="modal-title">Pengaturan Aplikasi</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="settings-title">Pengaturan Pajak & Diskon</div>
                
                <div class="form-group">
                    <label for="taxRate">Persentase Pajak (%)</label>
                    <input type="number" id="taxRate" class="form-control" min="0" max="100" step="0.1" placeholder="Masukkan persentase pajak">
                </div>
                
                <div class="form-group">
                    <label for="discountType">Tipe Diskon Default</label>
                    <select id="discountType" class="form-control">
                        <option value="percentage">Persentase (%)</option>
                        <option value="fixed">Nominal Tetap</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="discountValue">Nilai Diskon Default</label>
                    <div class="discount-input">
                        <input type="number" id="discountValue" class="form-control" min="0" placeholder="Masukkan nilai diskon">
                        <select id="discountValueType" class="form-control">
                            <option value="percentage">%</option>
                            <option value="fixed">Rp</option>
                        </select>
                    </div>
                </div>
                
                <div class="backup-section">
                    <div class="settings-title">Backup & Restore Data</div>
                    
                    <div class="form-group">
                        <label>Cadangkan data produk dan transaksi</label>
                        <div class="backup-actions">
                            <button id="backupDataBtn" class="btn btn-info">
                                <i class="fas fa-download"></i> Backup Data
                            </button>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Restore data dari backup</label>
                        <div class="file-input-wrapper">
                            <button class="btn btn-warning btn-block">
                                <i class="fas fa-upload"></i> Pilih File Backup
                            </button>
                            <input type="file" id="restoreFile" accept=".json">
                        </div>
                        <small class="text-muted">Pilih file backup (.json) untuk mengembalikan data</small>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary close-settings-modal">Batal</button>
                <button class="btn btn-success save-settings"><i class="fas fa-save"></i> Simpan Pengaturan</button>
            </div>
        </div>
    </div>

    <!-- Additional Fee Modal -->
    <div id="additionalFeeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Biaya Tambahan</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="additional-fee-options">
                    <div class="additional-fee-option">
                        <input type="radio" id="feeNone" name="additionalFee" value="none" checked>
                        <label for="feeNone">Tidak Ada</label>
                    </div>
                    <div class="additional-fee-option">
                        <input type="radio" id="feeShipping" name="additionalFee" value="shipping">
                        <label for="feeShipping">Biaya Kirim/Antar</label>
                    </div>
                    <div class="additional-fee-option">
                        <input type="radio" id="feeOther" name="additionalFee" value="other">
                        <label for="feeOther">Biaya Lainnya</label>
                    </div>
                </div>
                
                <div id="shippingFeeDetails" class="additional-fee-details">
                    <div class="form-group">
                        <label for="shippingFeeAmount">Biaya Kirim/Antar</label>
                        <input type="number" id="shippingFeeAmount" class="form-control" placeholder="Masukkan biaya kirim">
                    </div>
                </div>
                
                <div id="otherFeeDetails" class="additional-fee-details">
                    <div class="form-group">
                        <label for="otherFeeAmount">Jumlah Biaya</label>
                        <input type="number" id="otherFeeAmount" class="form-control" placeholder="Masukkan jumlah biaya">
                    </div>
                    <div class="form-group">
                        <label for="otherFeeDescription">Keterangan (maks. 180 karakter)</label>
                        <textarea id="otherFeeDescription" class="form-control" rows="2" maxlength="180" placeholder="Masukkan keterangan biaya"></textarea>
                        <div class="additional-fee-description">
                            <span id="charCount">0</span>/180 karakter
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary close-additional-fee-modal">Batal</button>
                <button class="btn btn-success save-additional-fee">Simpan Biaya</button>
            </div>
        </div>
    </div>

    <!-- Store Setup Modal -->
    <div id="setupModal" class="modal">
        <div class="setup-container">
            <div class="setup-title">Setup Toko</div>
            <form id="setupForm">
                <div class="form-group">
                    <label for="storeName">Nama Toko</label>
                    <input type="text" id="storeName" class="form-control" placeholder="Masukkan nama toko" required>
                    <div class="error-message" id="storeNameError"></div>
                </div>
                
                <div class="form-group">
                    <label>Anda sebagai:</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="ownerRole" name="userRole" value="owner" checked>
                            <label for="ownerRole">Owner</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="employeeRole" name="userRole" value="employee">
                            <label for="employeeRole">Karyawan</label>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="userPosition">Sebagai:</label>
                    <select id="userPosition" class="form-control" required>
                        <option value="kasir">Kasir</option>
                        <option value="owner">Owner</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="storeAddress">Alamat Toko</label>
                    <input type="text" id="storeAddress" class="form-control" placeholder="Masukkan alamat toko" required>
                    <div class="error-message" id="storeAddressError"></div>
                </div>
                
                <div class="form-group">
                    <label for="storePhone">Nomor HP</label>
                    <input type="tel" id="storePhone" class="form-control" placeholder="Masukkan nomor HP" required>
                    <div class="error-message" id="storePhoneError"></div>
                </div>
                
                <button type="submit" class="btn btn-block" id="saveSetupBtn">
                    <span id="saveSetupBtnText">Simpan</span>
                </button>
            </form>
        </div>
    </div>

    <!-- Main Container -->
    <div class="container" id="mainApp" style="display: none;">
        <!-- Header -->
        <div class="header">
            <div>
                <h1 id="storeNameHeader">Online Store</h1>
                <div class="header-subtitle">WebApp Versi.01.04.99 Copyright Lentera Karya Situbondo</div>
                <div class="header-subtitle">www.anekamarket.my.id</div>
            </div>
            <div class="header-info">
                <p id="currentDate">Senin, 1 Januari 2023</p>
                <p>Kasir: <span id="loggedInUser">Admin</span></p>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Left Panel -->
            <div class="left-panel">
                <h2 class="panel-title">Produk</h2>
                
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="productSearch" class="form-control" placeholder="Cari produk...">
                </div>

                <div id="productList" class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Nama</th>
                                <th>Harga</th>
                                <th>Stok</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="productListBody">
                            <!-- Products will be loaded here -->
                        </tbody>
                    </table>
                </div>
                
                <button id="addProductBtn" class="btn btn-success btn-block">
                    <i class="fas fa-plus"></i> Tambah Produk
                </button>
            </div>

            <!-- Right Panel -->
            <div class="right-panel">
                <h2 class="panel-title">Transaksi</h2>
                
                <div id="cartItems">
                    <!-- Cart items will be loaded here -->
                </div>
                
                <div class="cart-summary">
                    <div class="summary-row">
                        <span class="summary-label">Subtotal:</span>
                        <span class="summary-value" id="cartSubtotal">Rp 0</span>
                    </div>
                    <div class="summary-row">
                        <span class="summary-label">Diskon:</span>
                        <span class="summary-value" id="cartDiscount">Rp 0</span>
                    </div>
                    <div class="summary-row">
                        <span class="summary-label">Pajak (<span id="taxPercentage">10</span>%):</span>
                        <span class="summary-value" id="cartTax">Rp 0</span>
                    </div>
                    <div class="additional-fee-section">
                        <div class="summary-row">
                            <span class="summary-label">Biaya Tambahan:</span>
                            <span class="summary-value" id="cartAdditionalFee">Rp 0</span>
                        </div>
                        <div id="additionalFeeDescription" class="summary-value" style="font-size: 0.8rem; color: #666; text-align: right;"></div>
                    </div>
                    <div class="summary-row total-row">
                        <span class="summary-label">Total:</span>
                        <span class="summary-value" id="cartTotal">Rp 0</span>
                    </div>
                </div>

                <div class="form-group mt-3">
                    <button id="addAdditionalFeeBtn" class="btn btn-outline btn-block">
                        <i class="fas fa-plus-circle"></i> Tambah Biaya
                    </button>
                </div>

                <div class="payment-methods">
                    <label>Metode Pembayaran:</label>
                    <div class="payment-method">
                        <input type="radio" id="cash" name="paymentMethod" value="cash" checked>
                        <label for="cash">Tunai</label>
                    </div>
                    <div class="payment-method">
                        <input type="radio" id="transfer" name="paymentMethod" value="transfer">
                        <label for="transfer">Transfer Bank</label>
                    </div>
                    <div class="payment-method">
                        <input type="radio" id="ewallet" name="paymentMethod" value="ewallet">
                        <label for="ewallet">E-Wallet</label>
                    </div>
                </div>

                <div class="form-group">
                    <label for="paymentAmount">Jumlah Pembayaran</label>
                    <input type="number" id="paymentAmount" class="form-control" placeholder="Masukkan jumlah pembayaran">
                </div>

                <button id="completePayment" class="btn btn-success btn-block">
                    <i class="fas fa-print"></i> Selesaikan & Cetak
                </button>
            </div>
        </div>
    </div>

    <!-- Receipt Template (Hidden) -->
    <div id="receiptPrint" style="display: none;">
        <div class="receipt receipt-enhanced">
            <div class="receipt-header">
                <div class="receipt-brand">WebApp Versi.010499 By.Cendhanu</div>
                <div class="receipt-brand">Lentera Karya Situbondo</div>
                <div class="receipt-title" id="receiptStoreName">ONLINE STORE</div>
                <div class="receipt-address" id="receiptStoreAddress">Kabupaten Situbondo - Provinsi Jawa Timur</div>
                <div class="receipt-address" id="receiptStorePhone">Telp: 081234567890</div>
                <div class="receipt-date" id="receiptDate">01/01/2023 10:00:00</div>
                <div id="receiptTransactionId">No. Transaksi: T20230101000000</div>
            </div>
            <div class="receipt-items" id="receiptItems">
                <!-- Items will be added here -->
            </div>
            <div class="receipt-total">
                <div class="receipt-item">
                    <span>Subtotal</span>
                    <span id="receiptSubtotal">Rp 0</span>
                </div>
                <div class="receipt-item">
                    <span>Diskon</span>
                    <span id="receiptDiscount">Rp 0</span>
                </div>
                <div class="receipt-item">
                    <span>Pajak (<span id="receiptTaxPercentage">10</span>%)</span>
                    <span id="receiptTax">Rp 0</span>
                </div>
                <div class="receipt-item" id="receiptAdditionalFeeItem" style="display: none;">
                    <span id="receiptAdditionalFeeLabel">Biaya Tambahan</span>
                    <span id="receiptAdditionalFeeValue">Rp 0</span>
                </div>
                <div class="receipt-item">
                    <span>TOTAL</span>
                    <span id="receiptTotal">Rp 0</span>
                </div>
                <div class="receipt-item">
                    <span id="receiptPaymentMethod">Tunai</span>
                    <span id="receiptPaymentAmount">Rp 0</span>
                </div>
                <div class="receipt-item">
                    <span>Kembali</span>
                    <span id="receiptChange">Rp 0</span>
                </div>
            </div>
            <div class="receipt-footer">
                <div>Terima kasih telah berbelanja</div>
                <div class="receipt-order-info">Order Aplikasi Payment Pro</div>
                <div class="receipt-order-info">kirim email: lenterakaryasitubondo@gmail.com</div>
                <div>Kasir: <span id="receiptCashier">Admin</span></div>
            </div>
        </div>
        <div class="print-button no-print">
            <button id="printReceiptBtn" class="btn btn-primary">
                <i class="fas fa-print"></i> Cetak Struk
            </button>
            <button id="downloadReceiptBtn" class="btn btn-success ml-2">
                <i class="fas fa-download"></i> Download PDF
            </button>
            <button id="closeReceiptBtn" class="btn btn-secondary ml-2">
                <i class="fas fa-times"></i> Tutup
            </button>
        </div>
    </div>

    <!-- Add/Edit Product Modal -->
    <div id="productModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="productModalTitle">Tambah Produk</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="productId">
                <div class="form-group">
                    <label for="productName">Nama Produk</label>
                    <input type="text" id="productName" class="form-control" placeholder="Masukkan nama produk">
                    <div class="error-message" id="productNameError"></div>
                </div>
                <div class="form-group">
                    <label for="productCategory">Kategori</label>
                    <input type="text" id="productCategory" class="form-control" placeholder="Masukkan kategori">
                    <div class="error-message" id="productCategoryError"></div>
                </div>
                <div class="form-group">
                    <label for="productPrice">Harga</label>
                    <input type="number" id="productPrice" class="form-control" placeholder="Masukkan harga">
                    <div class="error-message" id="productPriceError"></div>
                </div>
                <div class="form-group">
                    <label for="productStock">Stok</label>
                    <input type="number" id="productStock" class="form-control" placeholder="Masukkan stok awal">
                    <div class="error-message" id="productStockError"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary close-product-modal">Batal</button>
                <button class="btn btn-success save-product"><i class="fas fa-save"></i> Simpan</button>
            </div>
        </div>
    </div>

    <!-- External Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <!-- Local JS -->
    <script src="main.js"></script>
</body>
</html>
